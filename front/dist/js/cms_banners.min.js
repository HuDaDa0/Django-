function Banners(){}Banners.prototype.addImageEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.removeBannerEvent=function(e){e.find(".close-btn").click(function(){var n=e.attr("data-banner-id");n?xfzalert.alertConfirm({text:"你确定要删除么？",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:n},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功！"))}})}}):e.remove()})},Banners.prototype.addSaveBannerEvent=function(d){d.find(".save-btn").click(function(){var n=d.find(".thumbnail"),e=d.find("input[name='priority']"),a=d.find("input[name='link_to']"),t=n.attr("src"),r=e.val(),i=a.val(),s=d.attr("data-banner-id"),o="";o=s?"/cms/edit_banner/":"/cms/add_banner/",xfzajax.post({url:o,data:{priority:r,link_to:i,image_url:t,pk:s},success:function(n){200===n.code&&(s?window.messageBox.showSuccess("修改成功"):(s=n.data.banner_id,d.attr("data-banner-id",s),window.messageBox.showSuccess("轮播图添加成功")),d.find(".priority").text("优先级："+r))}})})},Banners.prototype.listenAddBannersEvent=function(){var t=this;$("#add-banners").click(function(){var n=$(".banners-list-group");if(6<=n.children().length)window.messageBox.showInfo("最多只能添加6张轮播图");else{var e=template("banners-item");n.prepend(e);var a=n.find(".banner-item:first");t.addImageEvent(a),t.removeBannerEvent(a),t.addSaveBannerEvent(a)}})},Banners.prototype.loadData=function(){var o=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,a=$(".banners-list-group"),t=0;t<e.length;t++){var r=e[t],i=template("banners-item",{banner:r});a.append(i);var s=a.find(".banner-item:last");o.addImageEvent(s),o.removeBannerEvent(s),o.addSaveBannerEvent(s)}}})},Banners.prototype.run=function(){this.listenAddBannersEvent(),this.loadData()},$(function(){(new Banners).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNtc19iYW5uZXJzLmpzIl0sIm5hbWVzIjpbIkJhbm5lcnMiLCJwcm90b3R5cGUiLCJhZGRJbWFnZUV2ZW50IiwiYmFubmVySXRlbSIsImltYWdlIiwiZmluZCIsImltYWdlSW5wdXQiLCJjbGljayIsImNoYW5nZSIsImZpbGUiLCJ0aGlzIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwieGZ6YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwicHJvY2Vzc0RhdGEiLCJjb250ZW50VHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhdHRyIiwicmVtb3ZlQmFubmVyRXZlbnQiLCJiYW5uZXJJZCIsInhmemFsZXJ0IiwiYWxlcnRDb25maXJtIiwidGV4dCIsImNvbmZpcm1DYWxsYmFjayIsImJhbm5lcl9pZCIsInJlbW92ZSIsIndpbmRvdyIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZFNhdmVCYW5uZXJFdmVudCIsImltYWdlVGFnIiwicHJpb3JpdHlJbnB1dCIsImxpbmt0b0lucHV0IiwiaW1hZ2VfdXJsIiwicHJpb3JpdHkiLCJ2YWwiLCJsaW5rX3RvIiwicGsiLCJsaXN0ZW5BZGRCYW5uZXJzRXZlbnQiLCJzZWxmIiwiJCIsImJhbm5lcnNMaXN0R3JvdXAiLCJjaGlsZHJlbiIsImxlbmd0aCIsInNob3dJbmZvIiwidHBsIiwidGVtcGxhdGUiLCJwcmVwZW5kIiwibG9hZERhdGEiLCJnZXQiLCJiYW5uZXJzIiwiaSIsImJhbm5lciIsInJ1biJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsV0FNVEEsUUFBUUMsVUFBVUMsY0FBZ0IsU0FBVUMsR0FDeEMsSUFBSUMsRUFBUUQsRUFBV0UsS0FBSyxjQUN4QkMsRUFBYUgsRUFBV0UsS0FBSyxnQkFFakNELEVBQU1HLE1BQU0sV0FDUkQsRUFBV0MsVUFFZkQsRUFBV0UsT0FBTyxXQUNkLElBQUlDLEVBQU9DLEtBQUtDLE1BQU0sR0FDbEJDLEVBQVcsSUFBSUMsU0FDbkJELEVBQVNF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X2Jhbm5lcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQmFubmVycygpIHtcclxuXHJcbn1cclxuXHJcblxyXG4vLyDkuIrkvKDlm77niYdcclxuQmFubmVycy5wcm90b3R5cGUuYWRkSW1hZ2VFdmVudCA9IGZ1bmN0aW9uIChiYW5uZXJJdGVtKSB7XHJcbiAgICB2YXIgaW1hZ2UgPSBiYW5uZXJJdGVtLmZpbmQoJy50aHVtYm5haWwnKTtcclxuICAgIHZhciBpbWFnZUlucHV0ID0gYmFubmVySXRlbS5maW5kKCcuaW1hZ2UtaW5wdXQnKTtcclxuXHJcbiAgICBpbWFnZS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW1hZ2VJbnB1dC5jbGljaygpO1xyXG4gICAgfSk7XHJcbiAgICBpbWFnZUlucHV0LmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdO1xyXG4gICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9jbXMvdXBsb2FkX2ZpbGUvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiBmb3JtRGF0YSxcclxuICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXHJcbiAgICAgICAgICAgICdjb250ZW50VHlwZSc6IGZhbHNlLFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZS5hdHRyKCdzcmMnLCB1cmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG4vLyDngrnlh7vlhbPpl63mjInpkq5cclxuQmFubmVycy5wcm90b3R5cGUucmVtb3ZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoYmFubmVySXRlbSkge1xyXG4gICAgdmFyIGNsb3NlQnRuID0gYmFubmVySXRlbS5maW5kKCcuY2xvc2UtYnRuJyk7XHJcblxyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBiYW5uZXJJZCA9IGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnKTtcclxuICAgICAgICBpZiAoYmFubmVySWQpIHtcclxuICAgICAgICAgICAgeGZ6YWxlcnQuYWxlcnRDb25maXJtKHtcclxuICAgICAgICAgICAgICAgICd0ZXh0JzogJ+S9oOehruWumuimgeWIoOmZpOS5iO+8nycsXHJcbiAgICAgICAgICAgICAgICAnY29uZmlybUNhbGxiYWNrJzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd1cmwnOiAnL2Ntcy9kZWxldGVfYmFubmVyLycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Jhbm5lcl9pZCc6IGJhbm5lcklkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfova7mkq3lm77liKDpmaTmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcbi8vIOeCueWHu+S/neWtmOS6i+S7tu+8jOWwhui9ruaSreWbvueahOWGheWuueS/neWtmOWIsOaVsOaNruW6k+S4rVxyXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRTYXZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoYmFubmVySXRlbSkge1xyXG4gICAgdmFyIHNhdmVCdG4gPSBiYW5uZXJJdGVtLmZpbmQoJy5zYXZlLWJ0bicpO1xyXG5cclxuICAgIHNhdmVCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbWFnZVRhZyA9IGJhbm5lckl0ZW0uZmluZCgnLnRodW1ibmFpbCcpO1xyXG4gICAgICAgIHZhciBwcmlvcml0eUlucHV0ID0gYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0ncHJpb3JpdHknXVwiKTtcclxuICAgICAgICB2YXIgbGlua3RvSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdsaW5rX3RvJ11cIik7XHJcblxyXG4gICAgICAgIHZhciBpbWFnZV91cmwgPSBpbWFnZVRhZy5hdHRyKCdzcmMnKTtcclxuICAgICAgICB2YXIgcHJpb3JpdHkgPSBwcmlvcml0eUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBsaW5rX3RvID0gbGlua3RvSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xyXG5cclxuICAgICAgICB2YXIgdXJsID0gJyc7XHJcbiAgICAgICAgaWYgKGJhbm5lcklkKSB7XHJcbiAgICAgICAgICAgIHVybCA9ICcvY21zL2VkaXRfYmFubmVyLyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdXJsID0gJy9jbXMvYWRkX2Jhbm5lci8nXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogdXJsLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICdwcmlvcml0eSc6IHByaW9yaXR5LFxyXG4gICAgICAgICAgICAgICAgJ2xpbmtfdG8nOiBsaW5rX3RvLFxyXG4gICAgICAgICAgICAgICAgJ2ltYWdlX3VybCc6IGltYWdlX3VybCxcclxuICAgICAgICAgICAgICAgICdwayc6IGJhbm5lcklkXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYmFubmVySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lcklkID0gcmVzdWx0WydkYXRhJ11bJ2Jhbm5lcl9pZCddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYW5uZXJJdGVtLmF0dHIoJ2RhdGEtYmFubmVyLWlkJywgYmFubmVySWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2Vzcygn6L2u5pKt5Zu+5re75Yqg5oiQ5YqfJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmlvcml0eVRhZyA9IGJhbm5lckl0ZW0uZmluZCgnLnByaW9yaXR5Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJpb3JpdHlUYWcudGV4dCgn5LyY5YWI57qn77yaJytwcmlvcml0eSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLmxpc3RlbkFkZEJhbm5lcnNFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBhZGRCYW5uZXJzID0gJCgnI2FkZC1iYW5uZXJzJyk7XHJcblxyXG4gICAgYWRkQmFubmVycy5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJhbm5lcnNMaXN0R3JvdXAgPSAkKCcuYmFubmVycy1saXN0LWdyb3VwJyk7XHJcbiAgICAgICAgdmFyIGxlbmd0aCA9IGJhbm5lcnNMaXN0R3JvdXAuY2hpbGRyZW4oKS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGlmIChsZW5ndGggPj0gNikge1xyXG4gICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93SW5mbygn5pyA5aSa5Y+q6IO95re75YqgNuW8oOi9ruaSreWbvicpO1xyXG4gICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoJ2Jhbm5lcnMtaXRlbScpO1xyXG4gICAgICAgIGJhbm5lcnNMaXN0R3JvdXAucHJlcGVuZCh0cGwpO1xyXG5cclxuICAgICAgICAvLyDojrflj5bliJrliJrmt7vliqDnmoTnrKzkuIDkuKogYmFubmVyLWl0ZW1cclxuICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lcnNMaXN0R3JvdXAuZmluZCgnLmJhbm5lci1pdGVtOmZpcnN0Jyk7XHJcbiAgICAgICAgLy8g5omn6KGM5LiK5Lyg5Zu+54mH55qE5Yqf6IO9XHJcbiAgICAgICAgc2VsZi5hZGRJbWFnZUV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgICAgIC8vIOeCueWHu+WFs+mXreaMiemSrlxyXG4gICAgICAgIHNlbGYucmVtb3ZlQmFubmVyRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICAgICAgLy8g54K55Ye75L+d5a2Y5oyJ6ZKu77yM5re75Yqg6L2u5pKt5Zu+XHJcbiAgICAgICAgc2VsZi5hZGRTYXZlQmFubmVyRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5sb2FkRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6ICcvY21zL2Jhbm5lcl9saXN0LycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhbm5lcnNMaXN0R3JvdXAgPSAkKCcuYmFubmVycy1saXN0LWdyb3VwJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiYW5uZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lciA9IGJhbm5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRwbCA9IHRlbXBsYXRlKCdiYW5uZXJzLWl0ZW0nLCB7J2Jhbm5lcic6IGJhbm5lcn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJhbm5lcnNMaXN0R3JvdXAuYXBwZW5kKHRwbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPluWImuWImua3u+WKoOeahCBiYW5uZXItaXRlbSAg5q+P5re75Yqg5LiA5LiqYmFubmVyLWl0ZW3lsLHkvJrnu5HlrprkuIvpnaLkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lcnNMaXN0R3JvdXAuZmluZCgnLmJhbm5lci1pdGVtOmxhc3QnKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmiafooYzkuIrkvKDlm77niYfnmoTlip/og71cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZEltYWdlRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g54K55Ye75YWz6Zet5oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmVCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDngrnlh7vkv53lrZjmjInpkq7vvIzmt7vliqDova7mkq3lm75cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZFNhdmVCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubGlzdGVuQWRkQmFubmVyc0V2ZW50KCk7XHJcbiAgICB0aGlzLmxvYWREYXRhKCk7XHJcbn07XHJcblxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYmFubmVycyA9IG5ldyBCYW5uZXJzKCk7XHJcbiAgICBiYW5uZXJzLnJ1bigpO1xyXG59KTtcclxuXHJcbiJdfQ==
