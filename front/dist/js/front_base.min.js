function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper")}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},$(function(){(new FrontBase).run()}),Auth.prototype.run=function(){this.listenShowHideEvent(),this.listenSwitchEvent(),this.listenSigninEvent(),this.listenImgCaptchaEvent(),this.listenSmsCaptchaEvent(),this.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),s=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),s.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".top-switch").click(function(){var t=e.scrollWrapper,n=t.css("left");(n=parseInt(n))<0?t.animate({left:"0"}):t.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var i=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),o=t.find("input[name='password']"),a=t.find("input[name='remember']");t.find("input[name='submit']").click(function(){var t=s.val(),n=o.val(),e=a.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e},success:function(t){if(200===t.code)i.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor===String)window.messageBox.show(n,"error");else for(var e in n){var s=n[e];window.messageBox.show(s[0],"error")}}},fail:function(t){}})})},Auth.prototype.listenSignupEvent=function(){var h=this,f=$(".signup-group");f.find(".submit").click(function(){var t=f.find("input[name='telephone']"),n=f.find("input[name='username']"),e=f.find("input[name='password1']"),s=f.find("input[name='password2']"),i=f.find("input[name='img_captcha']"),o=f.find("input[name='sms-captcha']"),a=t.val(),r=n.val(),c=e.val(),p=s.val(),u=i.val(),l=o.val();xfzajax.post({url:"/account/register/",data:{telephone:a,username:r,password1:c,password2:p,img_captcha:u,sms_captcha:l},success:function(t){if(200===t.code)h.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor===String)window.messageBox.show(n,"error");else for(var e in n){var s=n[e];window.messageBox.show(s[0],"error")}}},fail:function(t){window.messageBox.showError("服务器出现错误")}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(t){var n=this,e=$(".send");e.addClass("disable"),e.unbind("click");var s=60,i=setInterval(function(){s--,e.text(s+"s"),s<=0&&(clearInterval(i),e.removeClass("disable"),e.text("发送验证码"),n.listenSmsCaptchaEvent())},1e3);window.messageBox.showSuccess("你的验证码："+t.data.text)},Auth.prototype.listenSmsCaptchaEvent=function(){var s=this,n=$(".signup-group input[name='telephone']"),i=$(".send");i.click(function(){var t=n.val();t?xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){if(200==t.code){i.addClass("disable"),i.unbind("click");var n=60,e=setInterval(function(){n--,i.text(n+"s"),n<=0&&(clearInterval(e),i.removeClass("disable"),i.text("发送验证码"),s.listenSmsCaptchaEvent())},1e3);window.messageBox.showSuccess("你的验证码："+t.data.text)}},fail:function(){}}):window.messageBox.showError("请输入手机号码")})},$(function(){(new Auth).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJzY3JvbGxXcmFwcGVyIiwicHJvdG90eXBlIiwicnVuIiwibGlzdGVuQXV0aEJveEhvdmVyIiwiYXV0aEJveCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsImxpc3RlblNob3dIaWRlRXZlbnQiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlblNpZ25pbkV2ZW50IiwibGlzdGVuSW1nQ2FwdGNoYUV2ZW50IiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzZWxmIiwic2lnbmluQnRuIiwic2lnbnVwQnRuIiwiY2xvc2VCdG4iLCJjbGljayIsImNzcyIsImxlZnQiLCJzY3JvbGwiLCJjdXJyZW50TGVmdCIsInBhcnNlSW50IiwiYW5pbWF0ZSIsInNpZ25pbkdyb3VwIiwidGVsZXBob25lSW5wdXQiLCJmaW5kIiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJwb3N0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsIm1lc3NhZ2VPYmplY3QiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsIm1lc3NhZ2VCb3giLCJrZXkiLCJtZXNzYWdlcyIsImZhaWwiLCJlcnJvciIsInNpZ251cEdyb3VwIiwidXNlcm5hbWVJbnB1dCIsInBhc3N3b3JkSW5wdXQxIiwicGFzc3dvcmRJbnB1dDIiLCJpbWdDYXB0Y2hhSW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsImltZ19jYXB0Y2hhIiwic21zX2NhcHRjaGEiLCJzaG93RXJyb3IiLCJpbWdDYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJzbXNTdWNjZXNzRXZlbnQiLCJzbXNDYXB0Y2hhIiwiYWRkQ2xhc3MiLCJ1bmJpbmQiLCJjb3VudCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwic2hvd1N1Y2Nlc3MiLCJnZXQiXSwibWFwcGluZ3MiOiJBQUNBLFNBQVNBLGFBMkJULFNBQVNDLE9BQ0xDLEtBQUtDLFlBQWNDLEVBQUUsaUJBQ3JCRixLQUFLRyxjQUFnQkQsRUFBRSxtQkF6QjNCSixVQUFVTSxVQUFVQyxJQUFNLFdBQ3RCTCxLQUFLTSxzQkFHVFIsVUFBVU0sVUFBVUUsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVMLEVBQUUsYUFDWk0sRUFBY04sRUFBRSxrQkFFcEJLLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQUtwQlQsRUFBRSxZQUNrQixJQUFJSixXQUNWTyxRQVVkTixLQUFLSyxVQUFVQyxJQUFNLFdBQ2pCTCxLQUFLWSxzQkFDTFosS0FBS2Esb0JBQ0xiLEtBQUtjLG9CQUNMZCxLQUFLZSx3QkFDTGYsS0FBS2dCLHdCQUNMaEIsS0FBS2lCLHFCQUdUbEIsS0FBS0ssVUFBVWMsVUFBWSxXQUN2QmxCLEtBQUtDLFlBQVlTLFFBR3JCWCxLQUFLSyxVQUFVZSxVQUFZLFdBQ3ZCbkIsS0FBS0MsWUFBWVUsUUFHckJaLEtBQUtLLFVBQVVRLG9CQUFzQixXQUNqQyxJQUFJUSxFQUFPcEIsS0FDUHFCLEVBQVluQixFQUFFLGVBQ2RvQixFQUFZcEIsRUFBRSxlQUNkcUIsRUFBV3JCLEVBQUUsY0FFakJtQixFQUFVRyxNQUFNLFdBQ1pKLEVBQUtGLFlBQ0xFLEVBQUtqQixjQUFjc0IsSUFBSSxDQUFDQyxLQUFRLE1BR3BDSixFQUFVRSxNQUFNLFdBQ1pKLEVBQUtGLFlBQ0xFLEVBQUtqQixjQUFjc0IsSUFBSSxDQUFDQyxNQUFTLFFBR3JDSCxFQUFTQyxNQUFNLFdB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QWF6RSxFQUFFLFNBQ25CeUUsRUFBV0MsU0FBUyxXQUNwQkQsRUFBV0UsT0FBTyxTQUVsQixJQUFJQyxFQUFRLEdBQ1JDLEVBQVFDLFlBQVksV0FDcEJGLElBQ0FILEVBQVdNLEtBQUtILEVBQVEsS0FDcEJBLEdBQVMsSUFDVEksY0FBY0gsR0FDZEosRUFBV1EsWUFBWSxXQUN2QlIsRUFBV00sS0FBSyxTQUNoQjdELEVBQUtKLDBCQUVWLEtBQ0grQixPQUFPTSxXQUFXK0IsWUFBWSxTQUFXdEMsRUFBYSxLQUFRLE9BZ0NsRS9DLEtBQUtLLFVBQVVZLHNCQUF3QixXQUNuQyxJQUFJSSxFQUFPcEIsS0FDUGdDLEVBQWlCOUIsRUFBRSx5Q0FDbkJ5RSxFQUFhekUsRUFBRSxTQUNuQnlFLEVBQVduRCxNQUFNLFdBQ2IsSUFBSVksRUFBWUosRUFBZUssTUFDMUJELEVBR0RLLFFBQVE0QyxJQUFJLENBQ1IxQyxJQUFPLHdCQUNQQyxLQUFRLENBQ0pSLFVBQWFBLEdBRWpCUyxRQUFXLFNBQVVDLEdBQ2pCLEdBQXNCLEtBQWxCQSxFQUFhLEtBQVUsQ0FDdkI2QixFQUFXQyxTQUFTLFdBRXBCRCxFQUFXRSxPQUFPLFNBRWxCLElBQUlDLEVBQVEsR0FDUkMsRUFBUUMsWUFBWSxXQUNwQkYsSUFDQUgsRUFBV00sS0FBS0gsRUFBUSxLQUNwQkEsR0FBUyxJQUNUSSxjQUFjSCxHQUNkSixFQUFXUSxZQUFZLFdBQ3ZCUixFQUFXTSxLQUFLLFNBRWhCN0QsRUFBS0osMEJBRVYsS0FDSCtCLE9BQU9NLFdBQVcrQixZQUFZLFNBQVd0QyxFQUFhLEtBQVEsUUFHdEVVLEtBQVEsZUE1QlpULE9BQU9NLFdBQVdnQixVQUFVLGNBc0N4Q25FLEVBQUUsWUFDYSxJQUFJSCxNQUNWTSIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIOW8ueWHuueUqOaIt+WkmuWKn+iDvVxyXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubGlzdGVuQXV0aEJveEhvdmVyKCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJCgnLmF1dGgtYm94Jyk7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKCcudXNlci1tb3JlLWJveCcpO1xyXG5cclxuICAgIGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKTtcclxuICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKCk7XHJcbiAgICB9KTtcclxuXHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuXHJcbi8vIOeUqOaIt+eZu+W9lSDms6jlhozmoYZcclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIgPSAkKCcubWFzay13cmFwcGVyJyk7XHJcbiAgICB0aGlzLnNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgdGhpcy5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU2lnbnVwRXZlbnQoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuaGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5tYXNrV3JhcHBlci5oaWRlKCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkJ0biA9ICQoJy5zaWduaW4tYnRuJyk7XHJcbiAgICB2YXIgc2lnbnVwQnRuID0gJCgnLnNpZ251cC1idG4nKTtcclxuICAgIHZhciBjbG9zZUJ0biA9ICQoJy5jbG9zZS1idG4nKTtcclxuXHJcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOiAwfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOiAtNDAwfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAkKCcudG9wLXN3aXRjaCcpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2Nyb2xsID0gc2VsZi5zY3JvbGxXcmFwcGVyO1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNjcm9sbC5jc3MoJ2xlZnQnKTtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcblxyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2Nyb2xsLmFuaW1hdGUoeydsZWZ0JzogJzAnfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2Nyb2xsLmFuaW1hdGUoeydsZWZ0JzogJy00MDBweCd9KVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8g55m75b2V5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcbiAgICB2YXIgc3VibWl0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3N1Ym1pdCddXCIpO1xyXG5cclxuICAgIHN1Ym1pdC5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKCdjaGVja2VkJyk7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAncmVtZW1iZXInOiByZW1lbWJlclxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0LCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB7J3Bhc3N3b3JkJzogWyd4eHh4JywgJ3h4eHgnXSwgJ3RlbGVwaG9uZSc6IFsneHh4JywgJ3h4eHgnXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG1lc3NhZ2VPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3cobWVzc2FnZXNbMF0sICdlcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuLy8g5rOo5YaM5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ251cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpO1xyXG4gICAgdmFyIHN1Ym1pdCA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQnKTtcclxuXHJcbiAgICBzdWJtaXQuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZElucHV0MSA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmRJbnB1dDIgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zLWNhcHRjaGEnXVwiKTtcclxuXHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkSW5wdXQxLnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZElucHV0Mi52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zQ2FwdGNoYUlucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3JlZ2lzdGVyLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMSc6IHBhc3N3b3JkMSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDInOiBwYXNzd29yZDIsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6IHNtc19jYXB0Y2hhLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0LCAnZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB7J3Bhc3N3b3JkJzogWyd4eHh4JywgJ3h4eHgnXSwgJ3RlbGVwaG9uZSc6IFsneHh4JywgJ3h4eHgnXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG1lc3NhZ2VPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3cobWVzc2FnZXNbMF0sICdlcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfmnI3liqHlmajlh7rnjrDplJnor68nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKCcuaW1nLWNhcHRjaGEnKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGltZ0NhcHRjaGEuYXR0cignc3JjJywgJy9hY2NvdW50L2ltZ19jYXB0Y2hhLycgKyAnP3JhbmRvbT0nICsgTWF0aC5yYW5kb20oKSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNtc1N1Y2Nlc3NFdmVudCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzbXNDYXB0Y2hhID0gJCgnLnNlbmQnKTtcclxuICAgIHNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGUnKTtcclxuICAgIHNtc0NhcHRjaGEudW5iaW5kKCdjbGljaycpO1xyXG5cclxuICAgIHZhciBjb3VudCA9IDYwO1xyXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvdW50LS07XHJcbiAgICAgICAgc21zQ2FwdGNoYS50ZXh0KGNvdW50ICsgJ3MnKTtcclxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZScpO1xyXG4gICAgICAgICAgICBzbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDApO1xyXG4gICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoXCLkvaDnmoTpqozor4HnoIHvvJpcIiArIHJlc3VsdFsnZGF0YSddWyd0ZXh0J10pO1xyXG59O1xyXG4vL1xyXG4vLyBBdXRoLnByb3RvdHlwZS5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbi8vICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuLy8gICAgIHZhciBzbXNDYXB0Y2hhID0gJCgnLnNlbmQnKTtcclxuLy8gICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuLy8gICAgICAgICBpZiAoIXRlbGVwaG9uZSkge1xyXG4vLyAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoJ+ivt+i+k+WFpeaJi+acuuWPt+eggScpO1xyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHhmemFqYXguZ2V0KHtcclxuLy8gICAgICAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvc21zX2NhcHRjaGEvJyxcclxuLy8gICAgICAgICAgICAgICAgICdkYXRhJzoge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVcclxuLy8gICAgICAgICAgICAgICAgIH0sXHJcbi8vICAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT0gMjAwKSB7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KHJlc3VsdCk7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICAgICAgfSxcclxuLy8gICAgICAgICAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKCkge1xyXG4vL1xyXG4vLyAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICB9KTtcclxuLy9cclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KTtcclxuLy9cclxuLy8gfTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHNtc0NhcHRjaGEgPSAkKCcuc2VuZCcpO1xyXG4gICAgc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIGlmICghdGVsZXBob25lKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcign6K+36L6T5YWl5omL5py65Y+356CBJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDop6PpmaQgc21zQ2FwdGNoYSDnu5HlrprnmoRjbGlja+S6i+S7tu+8jCDov5nmoLflnKjov5vooYzlgJLorqHml7bml7bvvIzlsLHkvJrpmLvmraLnlKjmiLflho3mrKHngrnlh7tcclxuICAgICAgICAgICAgICAgICAgICAgICAgc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSA2MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQtLTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEudGV4dChjb3VudCArICdzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtc0NhcHRjaGEucmVtb3ZlQ2xhc3MoJ2Rpc2FibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWAkuiuoeaXtue7k+adn+aXtu+8jOimgee7mXNtc0NhcHRjaGHph43mlrDnu5HlrppjbGlja+S6i+S7tlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuS9oOeahOmqjOivgeegge+8mlwiICsgcmVzdWx0WydkYXRhJ11bJ3RleHQnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICdmYWlsJzogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSk7XHJcblxyXG5cclxuXHJcbiJdfQ==
